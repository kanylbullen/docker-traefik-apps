# PostgreSQL Role Environment Configuration - Multi-Instance Support
# Copy this to .env and customize for your PostgreSQL deployment

# =============================================================================
# INSTANCE DECLARATIONS
# =============================================================================
# Define all instances to be deployed when running: ./install-role.sh postgresql install-all
# Format: INSTANCES="instance1,instance2,instance3"
# Use "default" for the main instance accessible without prefix

INSTANCES="default,dev,prod"

# =============================================================================
# GLOBAL CONFIGURATION (applies to all instances)
# =============================================================================

# Database Configuration (can be overridden per instance)
POSTGRES_PASSWORD=your-super-secure-password-here
POSTGRES_DB=homelab
POSTGRES_USER=homelab

# PostgreSQL Configuration
POSTGRES_PORT=5432
POSTGRES_VERSION=15

# Network Configuration
EXPOSE_POSTGRES=false

# pgAdmin Configuration
PGADMIN_DEFAULT_EMAIL=admin@${DOMAIN}
PGADMIN_DEFAULT_PASSWORD=your-pgadmin-password-here

# pgAdmin Authentication (optional - additional layer)
# Generate with: htpasswd -nb admin 'yourpassword'
POSTGRES_DASHBOARD_AUTH=

# Backup Configuration
POSTGRES_BACKUP_RETENTION_DAYS=7
POSTGRES_BACKUP_SCHEDULE="0 3 * * *"  # Daily at 3 AM

# Security Configuration
POSTGRES_INITDB_ARGS=--auth-host=md5

# =============================================================================
# INSTANCE-SPECIFIC CONFIGURATION
# =============================================================================
# Override global settings for specific instances
# Format: <INSTANCE_NAME>_<VARIABLE_NAME>=value

# Default instance configuration (accessed at pgadmin.${DOMAIN})
default_POSTGRES_DB=homelab
default_POSTGRES_USER=homelab
default_POSTGRES_DASHBOARD_AUTH=
default_PGADMIN_DEFAULT_EMAIL=admin@homelab.local

# Development instance configuration (accessed at dev-pgadmin.${DOMAIN})
dev_POSTGRES_PASSWORD=dev123
dev_POSTGRES_DB=homelab_dev
dev_POSTGRES_USER=dev_user
dev_POSTGRES_DASHBOARD_AUTH=
dev_PGADMIN_DEFAULT_EMAIL=dev@homelab.local
dev_PGADMIN_DEFAULT_PASSWORD=dev123
dev_EXPOSE_POSTGRES=true

# Production instance configuration (accessed at prod-pgadmin.${DOMAIN})
prod_POSTGRES_PASSWORD=prod-super-secure-password-here
prod_POSTGRES_DB=homelab_prod
prod_POSTGRES_USER=prod_user
prod_POSTGRES_DASHBOARD_AUTH=admin:$2y$10$example.hash.here
prod_PGADMIN_DEFAULT_EMAIL=admin@prod.homelab.local
prod_PGADMIN_DEFAULT_PASSWORD=prod-secure-pgadmin-password
prod_POSTGRES_BACKUP_SCHEDULE="0 1 * * *"  # Daily at 1 AM for prod

# =============================================================================
# USAGE EXAMPLES
# =============================================================================
# Deploy all declared instances:
#   ./install-role.sh postgresql install-all
#
# Deploy specific instance:
#   ./install-role.sh postgresql dev install
#
# Check status of all instances:
#   ./install-role.sh postgresql status-all
#
# Instance access URLs (replace ${DOMAIN} with your domain):
#   • Default: pgadmin.${DOMAIN}
#   • Dev: dev-pgadmin.${DOMAIN}
#   • Prod: prod-pgadmin.${DOMAIN}
# - Single authentication layer
# - Different database names to avoid conflicts
