# =============================================================================
# HOMELAB CONFIGURATION - Enhanced
# =============================================================================
# Copy this file to .env and customize for your environment
# After editing, run: ./setup.sh (Linux/macOS) or .\setup.ps1 (Windows)

# -----------------------------------------------------------------------------
# DEPLOYMENT CONFIGURATION
# -----------------------------------------------------------------------------
# Choose your deployment type:
# - PUBLIC_DIRECT: Public access with port forwarding (80/443) and Traefik
#   Automatically detects public IP and creates DNS records via Cloudflare API
#   Set CLOUDFLARE_PROXY=true for orange cloud (proxied), false for gray cloud (DNS only)
# - PUBLIC_TUNNEL: Public access via Cloudflare Tunnel (no port forwarding needed)
#   Uses cloudflared for secure tunnel, Traefik optional for internal routing
# - PRIVATE_LOCAL: Private/local network only with Traefik for SSL termination
#   Issues Let's Encrypt certificates via DNS challenge, no public access
DEPLOYMENT_TYPE=PRIVATE_LOCAL

# For PUBLIC_DIRECT: Enable Cloudflare proxy (orange cloud) or DNS-only (gray cloud)
CLOUDFLARE_PROXY=false

# For PUBLIC_DIRECT: Auto-detect public IP or set manually
# AUTO_DETECT_IP=true
# PUBLIC_IP=your.public.ip.here

# -----------------------------------------------------------------------------
# CORE SETTINGS (Required)
# -----------------------------------------------------------------------------
# Your primary domain name (required) - must be a real domain you control
DOMAIN=example.com
ACME_EMAIL=you@example.com

# Optional: Additional domains for multi-domain setups
# Uncomment and configure if you want to use multiple domains
# DOMAIN2=another-domain.com
# DOMAIN3=third-domain.org

# Optional: Set timezone for containers (uncomment and customize)
TZ=UTC

# Optional: Set a custom project name (defaults to folder name)
# COMPOSE_PROJECT_NAME=homelab

# -----------------------------------------------------------------------------
# DNS & SSL CONFIGURATION (Required for HTTPS)
# -----------------------------------------------------------------------------
# Cloudflare API token with Zone:DNS:Edit permissions
# Get from: https://dash.cloudflare.com/profile/api-tokens
# Token template: Custom token with Zone:Zone:Read, Zone:DNS:Edit permissions
CF_DNS_API_TOKEN=put-your-cf-dns-token-here

# Optional: Cloudflare Zone ID (improves DNS challenge performance)
# Get from: Right sidebar on your domain's Cloudflare dashboard
# CF_ZONE_API_TOKEN=your-zone-id-here

# -----------------------------------------------------------------------------
# VPN & REMOTE ACCESS
# -----------------------------------------------------------------------------
# Tailscale ephemeral auth key (recommended) or reusable key
# Get from: https://login.tailscale.com/admin/settings/keys
# Choose "Ephemeral" and set expiry to 90+ days for production
TS_AUTHKEY=tskey-ephemeral-xxxxxxxxxxxxxxxx
TS_HOSTNAME=homelab

# Optional: Tailscale routes to advertise (e.g., "192.168.1.0/24,10.0.0.0/8")
# Only needed if you want to route traffic through this machine
# TS_ROUTES=

# Cloudflare tunnel token (optional, for zero-trust public access)
# Get from: https://one.dash.cloudflare.com/ -> Networks -> Tunnels -> Create
# Leave empty if you don't want public access
CLOUDFLARED_TOKEN=

# -----------------------------------------------------------------------------
# SECURITY SETTINGS (Required)
# -----------------------------------------------------------------------------
# Generate with: htpasswd -nb admin 'yourpassword'
# Or use: echo "admin:$(openssl passwd -apr1 'yourpassword')"
# Replace 'yourpassword' with a strong password
# Leave blank to disable authentication for local installations
TRAEFIK_DASHBOARD_AUTH=

# Optional: IP whitelist for admin services (Tailscale CGNAT range by default)
# Add your home/office IP ranges as needed: "100.64.0.0/10,192.168.1.0/24"
# Leave blank to disable IP restrictions for local installations
ADMIN_IP_WHITELIST=100.64.0.0/10

# -----------------------------------------------------------------------------
# DATABASE CREDENTIALS (Optional - for app profiles)
# -----------------------------------------------------------------------------
# Generate strong passwords: openssl rand -base64 32
# MYSQL_ROOT_PASSWORD=
# MYSQL_PASSWORD=
# POSTGRES_PASSWORD=

# -----------------------------------------------------------------------------
# CONTAINER IMAGES
# -----------------------------------------------------------------------------
# Pin specific versions for production stability
TRAEFIK_IMAGE=traefik:v3.0
PORTAINER_IMAGE=portainer/portainer-ce:2.19.4
WHOAMI_IMAGE=traefik/whoami:v1.10.1
SOCKET_PROXY_IMAGE=ghcr.io/tecnativa/docker-socket-proxy:0.1.1
CLOUDFLARED_IMAGE=cloudflare/cloudflared:2024.2.1
TAILSCALE_IMAGE=tailscale/tailscale:v1.58.2

# Optional: Use latest for development (uncomment to override above)
# TRAEFIK_IMAGE=traefik:latest
# PORTAINER_IMAGE=portainer/portainer-ce:latest
# WHOAMI_IMAGE=traefik/whoami:latest
# SOCKET_PROXY_IMAGE=ghcr.io/tecnativa/docker-socket-proxy:latest
# CLOUDFLARED_IMAGE=cloudflare/cloudflared:latest
# TAILSCALE_IMAGE=tailscale/tailscale:latest
